
 {% load static %}


<!DOCTYPE html>
<html lang="en">
    <!-- Head -->
    
<!-- Mirrored from offsetcode.com/themes/messenger/2.2.0/chat-direct.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 17 Apr 2025 20:15:49 GMT -->
<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1, shrink-to-fit=no, viewport-fit=cover">
        <meta name="color-scheme" content="light dark">

        <title>Messages</title>

        <!-- Favicon -->
        <link rel="shortcut icon" href="{% static 'assets/images/added/small.png' %}" type="image/x-icon">

        <!-- Font -->
        <link rel="preconnect" href="https://fonts.gstatic.com/">
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700" rel="stylesheet">

        <!-- Template CSS -->
        <!-- <link class="css-lt" rel="stylesheet" href="{% static 'assets_1/css/template.bundle.css' %}" media="(prefers-color-scheme: light)"> -->
        <link class="css-dk" rel="stylesheet" href="{% static 'assets_1/css/template.bundle.css' %}" media="(prefers-color-scheme: dark)">

        <!-- Theme mode -->
        <script>
            if (localStorage.getItem('color-scheme')) {
                let scheme = localStorage.getItem('color-scheme');

                const LTCSS = document.querySelectorAll('link[class=css-lt]');
                const DKCSS = document.querySelectorAll('link[class=css-dk]');

                [...LTCSS].forEach((link) => {
                    link.media = (scheme === 'light') ? 'all' : 'not all';
                });

                [...DKCSS].forEach((link) => {
                    link.media = (scheme === 'dark') ? 'all' : 'not all';
                });
            }
        </script>
        <style>
            body.dark-mode {
                background-color: #081c2c6b;
                color: white;
            }

            /* Light Mode Styles (Bootstrap default) */
            body.light-mode {
                background-color: #f8f9fa;
                color: black;
            }
        </style>
    </head>

    <body class="light-mode">
        <!-- Layout -->
        <div class="layout overflow-hidden">
           
            <!-- Navigation -->

            <!-- Sidebar -->
            <aside class="sidebar bg-light">
                <div class="tab-content h-100" role="tablist">
                   
                    <!-- Chats -->
                    <div class="tab-pane fade h-100 show active" id="tab-content-chats" role="tabpanel">
                        <div class="d-flex flex-column h-100 position-relative">
                            <div class="hide-scrollbar">

                                <div class="container py-8">
                                    <!-- Title -->
                                    <div class="mb-8">
                                        <div class="row justify-content-between align-items-center">
                                            <div class="col-auto">
                                                <a href="#" onclick="window.history.back();" class="text-inherit">
                                                    <div class="text-center">
                                                        <div>
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="red" class="bi bi-chevron-left" viewBox="0 0 16 16">
                                                                <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"/>
                                                              </svg>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                            <div class="col-auto">
                                                <h2 class="fw-bold m-0">Chats</h2>
                                            </div>
                                            <div class="col-auto  ms-auto">
                                                <a href="{% url 'home' %}" class="text-inherit">
                                                    <div class="text-center">
                                                        <div>
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="red" class="bi bi-house-gear" viewBox="0 0 16 16">
                                                                <path d="M7.293 1.5a1 1 0 0 1 1.414 0L11 3.793V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v3.293l2.354 2.353a.5.5 0 0 1-.708.708L8 2.207l-5 5V13.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 2 13.5V8.207l-.646.647a.5.5 0 1 1-.708-.708z"/>
                                                                <path d="M11.886 9.46c.18-.613 1.048-.613 1.229 0l.043.148a.64.64 0 0 0 .921.382l.136-.074c.561-.306 1.175.308.87.869l-.075.136a.64.64 0 0 0 .382.92l.149.045c.612.18.612 1.048 0 1.229l-.15.043a.64.64 0 0 0-.38.921l.074.136c.305.561-.309 1.175-.87.87l-.136-.075a.64.64 0 0 0-.92.382l-.045.149c-.18.612-1.048.612-1.229 0l-.043-.15a.64.64 0 0 0-.921-.38l-.136.074c-.561.305-1.175-.309-.87-.87l.075-.136a.64.64 0 0 0-.382-.92l-.148-.044c-.613-.181-.613-1.049 0-1.23l.148-.043a.64.64 0 0 0 .382-.921l-.074-.136c-.306-.561.308-1.175.869-.87l.136.075a.64.64 0 0 0 .92-.382zM14 12.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0"/>
                                                            </svg>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>                                    
                                    
                                    

                                    <!-- Search -->
                                    <!-- <div class="mb-6">
                                        <form action="#">
                                            <div class="input-group">
                                                <div class="input-group-text">
                                                    <div class="icon icon-lg">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                                                    </div>
                                                </div>

                                                <input type="text" class="form-control form-control-lg ps-0" placeholder="Search messages or users" aria-label="Search for messages or users...">
                                            </div>
                                        </form>
                                    </div> -->
                                    <div class="mb-6">
                                        <form method="GET" action="{% url 'my_chats' %}">
                                            <div class="input-group">
                                                <div class="input-group-text">
                                                    <div class="icon icon-lg">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                                                    </div>
                                                </div>
                                                <input type="text" name="q" class="form-control form-control-lg ps-0" placeholder="Search messages or users" value="{{ request.GET.q }}">
                                            </div>
                                        </form>
                                    </div>
                                    

                                    <!-- Chats -->
                                    <div class="card-list">
                                      {% if conversations %}
                                         {% for convo in conversations %}
                                        <!-- Card -->
                                        <a href="{% url 'chat_detail' convo.id %}" class="card border-0 text-reset">
                                            <div class="card-body">
                                                <div class="row gx-5">
                                                    <div class="col-auto">
                                                        <div class="avatar avatar-online">
                                                            <!-- <img src="{% static 'assets_1/img/avatars/6.jpg' %}" alt="#" class="avatar-img"> -->
                                                            <img class="avatar-img" 
                                                            src="{{ convo.product.image.url|default:'/static/assets/images/added/default-product.jpg' }}" 
                                                            alt="{{ convo.product.name }}">
                                                        </div>
                                                    </div>

                                                    <div class="col">
                                                        <div class="d-flex align-items-center mb-3">
                                                            <h5 class="me-auto mb-0">{{ convo.product.name }}</h5>
                                                            <span class="text-muted extra-small ms-2">{{ convo.started_at|date:"Y-m-d H:i" }}</span>
                                                        </div>

                                                        <div class="d-flex align-items-center">
                                                            <div class="line-clamp me-auto">
                                                              {% if request.user == convo.buyer %}
                                                              Seller: {{ convo.seller.username }}
                                                              {% else %}
                                                                  Buyer: {{ convo.buyer.username }}
                                                              {% endif %}
                                                            </div>

                                                            <div class="badge badge-circle bg-danger ms-5">
                                                                <span></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div><!-- .card-body -->
                                        </a>
                                           {% endfor %}
                                        <!-- Card -->
                                        {% else %}
                                        <p>You have no conversations yet.</p>
                                    {% endif %}

                                    </div>
                                    <!-- Chats -->
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </aside>
            <!-- Sidebar -->

            <!-- Chat -->
            <main class="main is-visible" data-dropzone-area="">
                <div class="container h-100">

                    <div class="d-flex flex-column h-100 position-relative">
                        <!-- Chat: Header -->
                        <div class="chat-header border-bottom py-4 py-lg-7">
                            <div class="row align-items-center">

                                <!-- Mobile: close -->
                                <div class="col-2 d-xl-none">
                                    <a class="icon icon-lg text-muted" href="#" data-toggle-chat="">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="red" class="bi bi-chevron-left" viewBox="0 0 16 16">
                                            <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"/>
                                          </svg>
                                    </a>
                                </div>
                                <!-- Mobile: close -->

                                <!-- Content -->
                                <div class="col-8 col-xl-12">
                                    <div class="row align-items-center text-center text-xl-start">
                                        <!-- Title -->
                                        <div class="col-12 col-xl-6">
                                            <div class="row align-items-center gx-5">
                                                <div class="col-auto">
                                                    <div class="avatar avatar-online d-none d-xl-inline-block">
                                                        <!-- Display the product image or fallback to a default product image -->
                                                        <img class="avatar-img" 
                                                             src="{{ conversation.product.image.url|default:'/static/assets/images/added/default-product.jpg' }}" 
                                                             alt="{{ conversation.product.name }}">
                                                    </div>
                                                    
                                                </div>

                                                <div class="col overflow-hidden">
                                                    <h2>Chat about {{ conversation.product.name }}</h2>
                                                    <p class="text-truncate">{% if request.user == conversation.buyer.username %}
                                                        Seller: {{ conversation.seller.username }}
                                                        {% else %}
                                                            Buyer: {{ conversation.buyer.username }}
                                                        {% endif %}<span class='typing-dots'><span>.</span><span>.</span><span>.</span></span></p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Title -->

                                        <!-- Toolbar -->
                                        <div class="col-xl-6 d-none d-xl-block">
                                            <div class="row align-items-center justify-content-end gx-6">
                                                <div class="col-auto">
                                                    <a href="#" class="icon icon-lg text-muted" data-bs-toggle="offcanvas" data-bs-target="#offcanvas-more" aria-controls="offcanvas-more">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                                                    </a>
                                                </div>

                                                <!-- <div class="col-auto">
                                                    <div class="avatar-group">
                                                        <a href="#" class="avatar avatar-sm" data-bs-toggle="modal" data-bs-target="#modal-user-profile">
                                                            <img class="avatar-img" 
                                                                 src="{% if msg.sender.profile_picture %}{{ msg.sender.profile_picture.url }}{% else %}{% static 'assets/images/added/user-profile.png' %}{% endif %}" 
                                                                 alt="Sender Avatar">
                                                        </a>
                                                
                                                        <a href="#" class="avatar avatar-sm" data-bs-toggle="modal" data-bs-target="#modal-profile">
                                                            <img class="avatar-img" 
                                                                 src="{% if msg.buyer.profile_picture %}{{ msg.buyer.profile_picture.url }}{% else %}{% static 'assets/images/added/user-profile.png' %}{% endif %}" 
                                                                 alt="Buyer Avatar">
                                                        </a>
                                                    </div>
                                                </div> -->
                                                
                                            </div>
                                        </div>
                                        <!-- Toolbar -->
                                    </div>
                                </div>
                                <!-- Content -->

                                <!-- Mobile: more -->
                                <div class="col-2 d-xl-none text-end">
                                    <a href="#" class="icon icon-lg text-muted" data-bs-toggle="offcanvas" data-bs-target="#offcanvas-more" aria-controls="offcanvas-more">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                                            <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
                                          </svg>
                                    </a>
                                </div>
                                <!-- Mobile: more -->

                            </div>
                        </div>
                        <!-- Chat: Header -->

                        <!-- Chat: Content -->
                        <div class="chat-body hide-scrollbar flex-1 h-100">
                            <div class="chat-body-inner">
                                <div class="py-6 py-lg-12">
                                    {% for msg in messages %}
                                        <!-- Incoming Message -->
                                        {% if msg.sender != request.user %}
                                        <div class="message">
                                            <a href="#" data-bs-toggle="modal" data-bs-target="#modal-user-profile" class="avatar avatar-responsive">
                                                <!-- Check if profile_picture exists before using its URL -->
                                                <img class="avatar-img" 
                                                     src="{% if msg.sender.profile_picture %}{{ msg.sender.profile_picture.url }}{% else %}{% static 'assets/images/added/user-profile.png' %}{% endif %}" 
                                                     alt="Avatar">
                                            </a>                                            
                        
                                            <div class="message-inner">
                                                <div class="message-body">
                                                    <div class="message-content">
                                                        <div class="message-text">
                                                            <p>{{ msg.content }}</p>
                                                        </div>
                        
                                                        <!-- Dropdown -->
                                                        <!-- <div class="message-action">
                                                            <div class="dropdown">
                                                                <a class="icon text-muted" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-vertical">
                                                                        <circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle>
                                                                    </svg>
                                                                </a>
                                                                <ul class="dropdown-menu">
                                                                    <li><a class="dropdown-item d-flex align-items-center" href="#">Edit</a></li>
                                                                    <li><a class="dropdown-item d-flex align-items-center" href="#">Reply</a></li>
                                                                    <li><hr class="dropdown-divider"></li>
                                                                    <li><a class="dropdown-item d-flex align-items-center text-danger" href="#">Delete</a></li>
                                                                </ul>
                                                            </div>
                                                        </div> -->
                                                    </div>
                                                </div>
                                                <div class="message-footer">
                                                    <span class="extra-small text-muted">{{ msg.timestamp|date:"Y-m-d H:i" }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- End Incoming Message -->
                        
                                        <!-- Outgoing Message -->
                                        {% else %}
                                        <div class="message message-out">
                                            <a href="#" data-bs-toggle="modal" data-bs-target="#modal-user-profile" class="avatar avatar-responsive">
                                                <!-- Check if profile_picture exists before using its URL -->
                                                <img class="avatar-img" 
                                                     src="{% if msg.sender.profile_picture %}{{ msg.sender.profile_picture.url }}{% else %}{% static 'assets/images/added/user-profile.png' %}{% endif %}" 
                                                     alt="Avatar">
                                            </a>
                                            
                                            <div class="message-inner" >
                                                <div class="message-body">
                                                    <div class="message-content">
                                                        <div class="message-text"  style="background-color: #ff0000af;">
                                                            <p>{{ msg.content }}</p>
                                                        </div>
                        
                                                        <!-- Dropdown -->
                                                        <!-- <div class="message-action">
                                                            <div class="dropdown">
                                                                <a class="icon text-muted" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-vertical">
                                                                        <circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle>
                                                                    </svg>
                                                                </a>
                                                                <ul class="dropdown-menu">
                                                                    <li><a class="dropdown-item d-flex align-items-center" href="#">Edit</a></li>
                                                                    <li><a class="dropdown-item d-flex align-items-center" href="#">Reply</a></li>
                                                                    <li><hr class="dropdown-divider"></li>
                                                                    <li><a class="dropdown-item d-flex align-items-center text-danger" href="#">Delete</a></li>
                                                                </ul>
                                                            </div>
                                                        </div> -->
                                                    </div>
                                                </div>
                                                <div class="message-footer">
                                                    <span class="extra-small text-muted">{{ msg.timestamp|date:"Y-m-d H:i" }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- End Outgoing Message -->
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chat: Content -->

                        <!-- Chat: Footer -->
                        <!-- Chat: Footer -->
                        <div class="chat-footer pb-3 pb-lg-7 position-absolute bottom-0 start-0">
                            <!-- Chat: Files -->
                            <div class="dz-preview bg-dark" id="dz-preview-row" data-horizontal-scroll="">
                            </div>
                            <!-- Chat: Files -->

                            <!-- Chat: Form -->
                            <form method="POST" action="{% url 'chat_detail' conversation.id|default:0 %}" class="chat-form rounded-pill bg-dark" data-emoji-form="">
                                {% csrf_token %}
                                <div class="row align-items-center gx-0">
                                    <div class="col-auto">
                                        <!-- <a href="#" class="btn btn-icon btn-link text-body rounded-circle" id="dz-btn">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-paperclip">
                                                <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                                            </svg>
                                        </a> -->
                                        <a href="#" class="input-group-text text-body pe-0" data-emoji-btn="">
                                            <span class="icon icon-lg">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="red" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-smile">
                                                    <circle cx="12" cy="12" r="10"></circle>
                                                    <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                                                    <line x1="9" y1="9" x2="9.01" y2="9"></line>
                                                    <line x1="15" y1="9" x2="15.01" y2="9"></line>
                                                </svg>
                                            </span>
                                        </a>
                                    </div>

                                    <div class="col">
                                        <div class="input-group">
                                            <textarea name="content" class="form-control px-0" placeholder="Type your message..." rows="1" data-emoji-input="" data-autosize="true"></textarea>

                                            <!-- <a href="#" class="input-group-text text-body pe-0" data-emoji-btn="">
                                                <span class="icon icon-lg">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-smile">
                                                        <circle cx="12" cy="12" r="10"></circle>
                                                        <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                                                        <line x1="9" y1="9" x2="9.01" y2="9"></line>
                                                        <line x1="15" y1="9" x2="15.01" y2="9"></line>
                                                    </svg>
                                                </span>
                                            </a> -->
                                        </div>
                                    </div>

                                    <div class="col-auto">
                                        <!-- Submit button for form -->
                                        <button type="submit" class="btn btn-icon btn-danger rounded-circle ms-5">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send">
                                                <line x1="22" y1="2" x2="11" y2="13"></line>
                                                <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </form>
                            <!-- Chat: Form -->
                        </div>
                        <!-- Chat: Footer -->

                        <!-- Chat: Footer -->
                    </div>

                </div>
            </main>
            <!-- Chat -->

        </div>
        <!-- Layout -->

        <script>
            // Wait for the page to load
            window.addEventListener('load', function() {
                // Check if the screen width is smaller than 1200px and the URL contains '/chat/my/'
                if (window.innerWidth < 1200 && window.location.pathname.match(/\/chat\/my\/.*/)) {
                    // Find the element with the data-toggle-chat attribute
                    const toggleBtn = document.querySelector('[data-toggle-chat]');
        
                    if (toggleBtn) {
                        // Trigger the same action as clicking the link
                        toggleBtn.click();
                    }
                }
            });
        </script>
        
        
        

        <!-- Scripts -->
        <script src="{% static 'assets_1/js/vendor.js' %}"></script>
        <script src="{% static 'assets_1/js/template.js' %}"></script>
    </body>

<!-- Mirrored from offsetcode.com/themes/messenger/2.2.0/chat-direct.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 17 Apr 2025 20:15:49 GMT -->
</html>
  












